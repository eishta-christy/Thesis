1.  Introduction.  The P3 is among the most widely studied components in eventrelated potential (ERP) research.  It comprises a family of brain potentials including the novelty P3 and the target P3 (Sutton, Braren, Zubin, & John, 1965.  for reviews, see Donchin & Coles, 1988 .  Picton, 1992.  Polich, 2007).  The novelty P3, or P3a, is a frontocentral positivity evoked by the onset of novel, non-target stimuli.  The target P3, or P3b, has a more posterior distribution and is evoked by the onset of task-relevant stimuli that require some type of mental or motor response.  In this paper, we focus on the P3b and its relationship with the timing and types of mental events culminating in behavioral responses.  A long held view is that the P3b reﬂects context updating.  when an incoming stimulus deviates from the representation maintained in working memory, the representation is updated and a P3b is generated (Donchin & Coles, 1988.  Donchin, 1981.  Polich, 2007.  but see Verleger, 1988).  Implicit in this and other theories is the idea that the P3b is only evoked once a stimulus has been categorized.  According to this stimulus-evaluation account, P3b latency can be used to divide processing into two general stages – stimulusrelated and response-related.  P3b latency is strongly affected by the duration of stimulus-related processing.  Many studies have conﬁrmed that P3b latency increases when stimulus categorization is difﬁcult (Coles, Gratton, Bashore, Eriksen, & Donchin, 1985.  Kutas, McCarthy, & Donchin, 1977.  Magliero, Bashore, Coles, & Donchin, 1984.  Twomey, Murphy, Kelly, & O’Connell, 2015).  Alternatively, P3b latency is weakly affected by manipulations that prolong response planning, particularly if there is little temporal overlap between stimulus categorization and motor preparation.  The relationship between the P3b and responding remains controversial, however.  Donchin and Coles ascribed the P3b (i. e. , the P300) a role in strategic processing (1988).  They proposed that the P3b is not involved in immediate responding per se, but rather in some overarching process that operates in parallel or afterwards.  For example, stimulus categorization could inﬂuence future behavior by causing strategy shifts or changes in cognitive control.  In support of this view, the P3b sometimes follows the response, suggesting that it does not directly relate to responses (for a review, see Donchin & Coles, 1988).  Additionally, correlations between P3b latencies and response times (RTs) are sometimes weak or absent, reinforcing the idea that the P3b does not directly contribute to responses.  Other evidence indicates that the P3b plays a role in tactical processing, however (O’Connell et al. , 2012.  Verleger, Grauhan, & ´Smigasiewicz, in press.  Verleger, Ja´skowski, & Wascher, 2005.  for a review, see Nieuwenhuis, Aston-Jones, & Cohen, 2005).  By this view, the P3b bridges stimulus categorization and response preparation within trials.  In support of this view, many studies have found that the P3b precedes responses, and that P3b latencies correlate with RTs (for a review, see Verleger, 1997).  This suggests that responses depend on the mental process reﬂected in the P3b.  Building on these ﬁndings, O’Connell et al.  (2012) demonstrated that the P3b could be treated as a build-to-decision variable that peaked with behavioral responses in a range of tasks that varied stimulus contrast and modality.  Further evidence comes from studies that compare temporal synchronization of the P3b with stimulus onset and response commission.  Verleger et al.  (2005) compared the amplitudes of the P3b in stimulus-locked and response-locked waveforms.  They reasoned that if the P3b relates only to stimulus processing, it would be time-locked to stimulus onset and its amplitude would be largest in stimulus-locked waveforms.  Conversely, if the P3b signiﬁes the conclusion of stimulus processing and the organization of a response, its amplitude would be equal in stimulus-locked and response-locked waveforms.  P3b amplitude was, in fact, equal in stimulus-locked and response-locked waveforms, consistent with its role in tactical processing.  To summarize, the tactical and strategic views both assume a relationship between stimulus categorization and the P3b.  They differ, however, in whether they ascribe the P3b a role in immediate responses or future behavior.  Existing studies of the P3b latency are limited in key ways.  Some have found little to no relationship between P3b latencies and RTs despite the fact that the experimental manipulations would be expected to affect stimulus processing (for a review, see Verleger, 1997).  This may reﬂect shortcomings of the underlying stimulusevaluation account and the tactical view of the P3b, or limitations of the methods used to measure P3b latency.  Additionally, the relationship between P3b latencies and RTs is typically assessed by comparing their averages in different conditions (McCarthy & Donchin, 1981.  Ritter, Simson, Vaughan, & Macht, 1982), or by binning trials according to RTs and comparing average P3b latencies from trials with fast versus slow responses (Friedman, 1984.  Roth, Ford, & Kopell, 1978).  Both approaches ignore information about trial-by-trial variability in P3b latencies and RTs.  The peak latency of the P3b varies within individuals on the order of tens of milliseconds (Nishida, Nakamura, Suwazono, Honda, & Shibasaki, 1997.  Pfefferbaum, Ford, Roth, & Kopell, 1980a,b), raising the possibility that trial-by-trial ﬂuctuations in P3b latencies relate to changes in RTs (but see Ramchurn, de Fockert, Mason, Darling, & Bunce, 2014 for an alternate view).  The majority of studies comparing P3b latencies to RTs use tasks where stimuli must be categorized before responding.  Simple detection tasks, which require merely detecting the onset of a single repeating target stimulus, also evoke a P3b (Mertens & Polich, 1997.  Polich & Heine, 1996.  Polich, Eischen, & Collins, 1994).  The ﬁnding that a continuously repeating target produces a P3b may seem to undermine the idea that the component reﬂects context updating.  However, given the ancillary assumption that the representation of context held in memory decays over time, the re-occurrence of the target may serve to restore the representation (Gonsalvez, Barry, Rushby, & Polich, 2007).  Even if such an update is obligatory, it is not needed to respond in simple detection tasks.  If the P3b occurs after stimulus categorization is complete, but initial encoding is all that is needed to respond, the P3b may come after responses and be less strongly associated with them in simple detection versus choice RT tasks.  In this paper, we present a novel method for detecting significant events in the EEG signal.  These events relate to early visual components, and later cognitive components such as the P3b.  We apply the method to data from three paradigms commonly used to study the P3b in order to understand how the component and its relationship to behavioral responses differs among tasks.  We describe the P3b task variants and the analytical technique next.  1. 1.  P3b task variations.  The P3b is robustly evoked in three variants of the oddball paradigm.  In the single stimulus variant, targets are presented after unpredictable temporal delays (Mertens & Polich, 1997.  Polich & Heine, 1996.  Polich et al. , 1994).  No other stimuli are shown, and participants are instructed to respond to targets.  In the two stimulus variant, target and standard distractor stimuli are presented (Duncan-Johnson & Donchin, 1977.  Squires, Squires, & Hillyard, 1975).  Target stimuli appear infrequently, and participants are instructed to respond to targets.  Finally, in the three stimulus variant, targets, standard distractors, and non-target distractors are presented (Comerchero & Polich, 1999.  Conroy & Polich, 2007).  Standard and non-target distractors differ in that non-target distractors are presented at the same (low) frequency as targets.  In all three tasks, targets produce a centroparietal positivity consistent with the P3b.  Non-target distractors, which appear infrequently in the three-stimulus paradigm, produce a more frontocentral P3a.  Finally, standard distractors produce little to no positive modulation during the time window of the P3.  Katayama and Polich (1996) recorded EEG from participants as they completed one-, two-, and three-stimulus oddball paradigms.  P3b peak amplitude was equivalent across tasks, while P3b peak latency was shorter in the one-stimulus oddball paradigm as compared to the two- and three-stimulus variants (see also, Walhovd & Fjell, 2001).  Within individuals, P3b amplitudes were correlated between all pairs of tasks, as were P3b latencies.  Other studies have also found that the topographical distribution of the P3b is consistent across one- and two-stimulus oddball tasks (Croft, Gonsalvez, Gabriel, & Barry, 2003), as are the neural generators inferred using source modeling (Tarkka & Stokic, 1998).  1. 2.  HSMM-MVPA.  Inspired in part by ERP-based mental chronometry pioneered with the P3b (Duncan-Johnson, 1981.  Kutas et al. , 1977.  Meyer, Osman, Irwin, & Yantis, 1988.  Pfefferbaum et al. , 1980a,b), we have developed a novel method for decomposing the EEG signal into a sequence of processing stages.  The method reveals information about the number and latencies of processing stages in a task, along with their associated scalp distributions (Anderson, Zhang, Borst, & Walsh, 2016.  Zhang, Walsh, & Anderson, in press).  Here, we apply the method to three paradigms known to evoke the P3b to better understand the types and timing of mental operations that occur in each.  The standard approach to analyzing EEG data in the time domain is to segment the continuous recording, align the segments to observable events such as the onset of a stimulus or the commission of a response, and average the signal across the segments to create event-related potentials, or ERPs (Luck, 2014.  Vaughan, 1969.  Walter, Cooper, Aldridge, McCallum, & Winter, 1964).  ERPs contain characteristic sequences of negative- and positive-going deﬂections, including the P3b.  Comparison of the ERPs obtained for different conditions of an experiment can reveal whether, when, and for how long a manipulation impacted mental processing.  Although this approach to EEG analysis has been extremely informative, it has two important limitations.  First, neural signals that are only weakly locked to observable events are attenuated in average waveforms because they occur at different times during different trials.  This is especially problematic for later signals that reﬂect variability from the durations of processes that precede them.  Second, ERPs represent average activity and discard information about differences in when various components appeared within each trial.  Trial-by-trial variability in component latencies could be informative with respect to understanding variability in overt behavioral responses.  To overcome these limitations, we developed a technique for applying hidden semi-Markov models and multivariate pattern analysis to EEG data (HSMM-MVPA.  Anderson et al. , 2016.  Zhang et al. , in press).  The method assumes that in the absence of taskrelated processing, the background EEG can be modeled as ongoing sinusoidal noise (Fig.  1, left), the amplitude of which varies by frequency according to a known power spectrum (Yeung, Bogacz, Holroyd, Nieuwenhuis, & Cohen, 2007).  Stimulus onset initiates task-related processing, and transitions from one cognitive stage to the next are marked by the superposition of bumps on the background EEG.  A bump is a multidimensional distribution of scalp activity, and is modeled as a half cycle of a 10 Hz sine wave (Fig.  1, middle).  The bump rises, peaks, and falls over 50 ms.  The recorded EEG contains ongoing sinusoidal noise along with the signal from one or more bumps (Fig.  1, right).  This conceptual model is consistent with the classical theory of ERP generation (Yeung et al. , 2007), in which ERPs arises from the addition of event-locked signals to the background EEG.  Others have argued that ERPs arise when an event causes the phase of an oscillation in a certain frequency band to be reset, causing its peaks and troughs to be aligned across trials (Basar, 1980).  Although these theories have different conceptual bases, both predict the appearance of phasic bumps time-locked to experiment events (Yeung, Bogacz, Holroyd, & Cohen, 2004, 2007) The intervals between bumps, referred to as ﬂats, contain only sinusoidal noise with mean zero.  The durations of ﬂats differ on a trial-by-trial basis, reﬂecting variability in the latencies of the underlying mental processes.  Flat durations are modeled as random variables drawn from gamma distributions (Fig.  2).  The HSMM estimates when bumps occurred during each trial, and the MVPA estimates the multidimensional scalp activity associated with a bump.  Using HSMM-MVPA, it is possible to infer the number, timing, and topography of bumps that maximize the likelihood of the EEG data.  We previously applied HSMM-MVPA to two studies of associative recognition and a study using the Sternberg Task (Anderson et al. , 2016.  Zhang et al. , in press).  In all of those cases, a computational cognitive model for the task had already been created using the integrated cognitive architecture ACT-R (Anderson, 2007).  The models contained predeﬁned numbers of processing stages, and speciﬁed how the durations of stages were impacted by the various experimental manipulations.  The main contribution of HSMMMVPA was to test whether the numbers and durations of stages inferred from the EEG were consistent with the computational models.  This constitutes a top-down application of HSMM-MVPA for testing existing theories.  HSMM-MVPA can also be used in a bottom-up manner to infer the number and durations of processing stages directly from the EEG.  We adopt the bottom-up approach in this paper.  1. 3.  Overview of current experiments.  We recorded EEG from participants as they performed three tasks.  the Psychomotor Vigilance Task (PVT.  Dinges & Powell, 1985), the Hitchcock Radar Task (Hitchcock, Dember, Warm, Moroney, & See, 1999), and the 3-Stimulus Task (Comerchero & Polich, 1999).  In the PVT, participants monitored the screen for the onset of a millisecond counter.  They responded when the counter appeared.  In the Hitchcock Radar Task, participants saw frequent non-critical signals and infrequent critical signals.  They responded to critical signals only.  Finally, in the 3-Stimulus Task, participants saw frequent distractors, rare distractors, and targets.  They responded to targets only.  The particular tasks were selected for reasons unrelated to the current paper.  Yet they exemplify the one, two-, and three-stimulus oddball paradigms commonly used to study the P3b.  We applied HSMM-MVPA to EEG data from these tasks to address two questions.  First, does HSMM-MVPA reveal a stage with a bump corresponding to the P3b.  Based on the existing literature, we expected to see such a bump after counter onset in the PVT, after critical signals in the Radar Task, and after targets in the 3-Stimulus Task.  Second, is the latency of the P3b stage associated with RTs.  Both the Radar and 3-Stimulus Task require categorizing stimuli before responding.  As such, we expected responses to follow, and be synchronized with, the P3b stage in trials of those tasks.  The PVT only requires detecting a stimulus before responding.  Consequently, it was unclear whether responses would precede or follow the P3b in the PVT, and whether RTs would relate to P3b latencies.  <Middle> 2.  Methods.  2. 1.  Participants.  Thirty individuals from the University of Dayton community participated in a single two hour session for monetary compensation (10 men and 20 women, ages ranging from 18 to 36 with a mean of 22. 7).  27 were right-handed.  None reported a history of neurological impairment.  2. 2.  Tasks.  Each participant completed three tasks.  the Psychomotor Vigilance Task (PVT), the 3-Stimulus Task, and the Radar Task.  The tasks were separated by ﬁve-minute breaks.  Because the Radar Task was longest, all participants completed that task ﬁrst, followed by the PVT and the 3-Stimulus Task.  We describe the tasks, and later the results, in order of task difﬁculty as inferred from RTs.  Responses were fastest in PVT, followed by the 3-Stimulus Task, and the Radar2. 2. 1.  Psychomotor vigilance task.  The PVT is frequently used in sleep research (Dinges & Powell, 1985.  Lim & Dinges, 2008).  Participants monitored a display for the onset of a visual millisecond counter within a box that was 5 cm wide by 1 cm high.  The counter started from zero and continuously incremented until the participant responded, or until 30 s passed.  Elapsed time remained on the screen for 1 s after the participant responded and served as performance feedback.  The next trial began from 1 to 9 s after feedback was extinguished.  The cumulative duration of the inter-trial interval (including 1 s for feedback) was randomly drawn from a uniform integer distribution ranging from 2 to 10 s.  The counter and feedback appeared in white against a black background.  Participants were instructed to respond as quickly as possible, but to avoid responding before the stimulus appeared.  They pressed the “J” key on a standard keyboard using their right index ﬁnger.  Participants were given 1 min of practice on the PVT.  Following a short break, they performed the task continuously for 10 min.  2. 2. 2.  3-Stimulus task.  The 3-Stimulus Task was based on the visual condition of two prior studies (Comerchero & Polich, 1999.  Conroy & Polich, 2007).  In each trial, participants viewed a target, a non-target distractor, or a standard distractor.  Targets and non-target distractors each appeared in 10% of trials, and standard distractors appeared in the remaining 80% of trials.  The target was a large circle (2. 5 cm diameter), the non-target distractor was a large square (2. 5 cm height), and the standard distractor was a small circle (1. 6 cm diameter).  Stimuli were presented in blue against a black background.  A stimulus appeared once every 2 s, and remained on the screen for 75 ms.  Participants were instructed to respond to targets and to ignore non-target and standard distractors.  They pressed the “J” key on a standard keyboard using their right index ﬁnger.  Participants were given 20 practice trials.  Following a short break, they completed 4 blocks of 90 trials.  After each block, they received feedback about the percentages of targets detected (i. e. , hits), and non-target and standard distractors ignored (i. e. , correct rejects).  2. 2. 3.  Radar task.  The Radar Task was based on a study by Hitchcock et al.  (1999).  A stimulus display with a ﬁlled central circle (1. 6 cm diameter) and three concentric rings (2. 8 cm, 3. 9 cm, and 5. 1 cm diameters) appeared in each trial (Fig.  3).  Two line segments (0. 15 cm wide by 1. 4 cm long) were superimposed on the concentric rings.  Participants were told that the ﬁlled circle nominally corresponds to a city, and the line segments to two jets.  They were instructed to respond if the two jets were on a collision path with one another (i. e. , the line segments were colinear).  Critical events occurred in 3. 3% (10 out of every 300) trials.  Stimulus displays were presented in white against a black background.  A new display appeared every 2 s and remained on the screen for 300 ms.  Participants were instructed to respond to critical events and to ignore non-critical events.  They pressed the “J” key on a standard keyboard using their right index ﬁnger.  Participants were given 200 practice trials.  During practice, they received feedback about the percentages of critical events detected and non-critical events ignored after every 50 trials.  Following a short break, they performed the task continuously for 40 min (1600 trials) without feedback or breaks.  2. 3.  EEG recording and analysis.  Stimuli were presented on a 60 Hz LCD monitor placed approximately 60 cm from participants.  The EEG was recorded from 64 Ag-AgCl sintered electrodes (10–20 system) using a Biosemi Active II System (BioSemi, Amsterdam, Netherlands).  Voltage offsets were reduced to 40 mV or less, and the resting EEG was checked for any problematic electrodes prior to recording. 1 The EEG was rereferenced online to the combined common mode sense (CMS) and driven right leg (DRL) circuit.  Electrodes were also placed on the right and left mastoids.  Scalp recordings were algebraically rereferenced ofﬂine to the average of the right and left mastoids.  The EEG signals were ﬁltered with a bandpass of 0. 1–70. 0 Hz and were digitized at 512 Hz.  The EEG recording was decomposed into independent components using the EEGLAB FastICA algorithm (Delorme & Makeig, 2004).  Components associated with eye blinks were automatically identiﬁed and projected out of the EEG recording.  Epochs of 1200 ms (including a 200 ms baseline) were then extracted from the continuous recording and corrected over the prestimulus interval.  Epochs containing voltages above +100  were excluded from further analysis.  One participant with less than 30% artifact free data was excluded from the PVT, two participants were excluded from the 3-Stimulus Task, and two participants were excluded from the Radar Task.  The P3b is typically deﬁned in terms of its topographical distribution along the midline and over the frontal, central, and parietal scalp (Comerchero & Polich, 1999.  Conroy & Polich, 2007).  Accordingly, we averaged across contiguous electrodes to create three regions.  a frontal region (AF3, Fpz, AFz, Fz, AF4), a central region (C1, FCz, Cz, CPz, C2), and a parietal region (P1, CPz, Pz, POz, P2).  P3b latency varies by task.  For the PVT, we analyzed waveforms evoked by the onset of the visual millisecond counter.  We quantiﬁed the P3b as mean voltage from 250 to 500 ms (Witkowski et al. , 2015).  For the 3-Stimulus Task, we compared waveforms evoked by the onset of targets, non-target distractors, and standard distractors.  We quantiﬁed the P3b as mean voltage from 350 to 500 ms (Comerchero & Polich, 1999).  Lastly, for the Radar Task, we analyzed waveforms evoked by the onset of critical and non-critical events.  Only one previous EEG study of the Radar Task has been published (Kamzanova, Kustubayeva, & Matthews, 2014), and that study did not analyze ERPs.  As such, the interval used to quantify the P3b (450–800 ms) in the Radar Task was based on visual inspection of the waveforms.  For all analyses involving factors with more than two levels, we adjusted the p values using the Greenhouse-Geisser correction.  2. 4.  HSMM-MVPA analysis.  HSMM-MVPA models the variability of endogenous ERP components that may otherwise be distorted or lost in average waveforms (Anderson et al. , 2016.  Zhang et al. , in press).  The method identiﬁes brief periods of activity characterized by distinctive patterns of voltages across the scalp called bumps.  Bumps occur at variable latencies in the single-trial EEG, and signify changes in information processing.  Bumps are separated by ﬂat periods where the mean of the ongoing sinusoidal noise is zero.  Flat durations vary by trial, and are treated as random variables drawn from gamma distributions.  The HSMM estimates the locations of bumps during each trial, and the MVPA estimates their scalp topographies.  The EEG data were pre-processed in the same manner as for the ERP analyses.  Two additional steps of dimensionality reduction were performed to increase the efﬁciency and tractability of HSMM-MVPA.  First, the data were interpolated and down-sampled to 100 Hz (i. e. , 10-ms samples).  Second, because signals from different EEG electrodes are highly inter-correlated, spatial PCA was performed and scores of the ﬁrst 10 PCA components were retained.  These accounted for 86% of variance in the EEG signal during the PVT, 85% of variance during the 3-Stimulus Task, and 83% variance during the Radar Task. 2 The PCA components were z-scored for each trial.  The ﬁnal data consisted of 10 orthogonal PCA components sampled every 10 ms and with constant mean and variability across trials.  HSMM-MVPA contains three ancillary assumptions.  First, bumps have a 50 ms duration (i. e. , 5 samples) and a half-sine shape.  The use of such narrow bumps promotes precision in the identiﬁcation of stage boundaries, and allows HSMM-MVPA to simultaneously identify components with power focused in higher frequencies (e. g. , the N1) and lower frequencies (e. g. , the P3b).  Previously, we found that HSMM-MVPA with a 50 ms bump accurately recovered the temporal location of 3 Hz signals (Anderson et al. , 2016), which is important given that the P3b reﬂects power in the delta and theta bands (Demiralp, Ademoglu, Comerchero, & Polich, 2001).  Second, bumps occur serially and do not overlap.  Third, ﬂat durations are modeled as a gamma distribution with a ﬁxed shape parameter 2 and a scale parameter estimated to ﬁt the data.  See Anderson et al.  (2016) for a detailed discussion of these assumptions, and demonstrations of the robustness of the method against violations of each.  In our previous studies, we used HSMM-MVPA to place n bumps between stimulus onset and response commission (Anderson et al. , 2016.  Zhang et al. , in press).  Fitting an n-bump HSMM requires estimating n + 1 stage distributions to describe the n + 1 periods of time collectively demarked by stimulus onset, the n bumps, and the response.  Most trials in the current tasks do not end with responses.  As such, we ﬁt n-bump HSMMs to the EEG from the ﬁrst full second of every trial in all tasks. 3 This requires estimating n stage distributions to describe the duration of the ﬂat preceding the ﬁrst bump, and the durations of the ﬂats separating the subsequent bumps.  Since the speciﬁc interval of time used in the HSMM-MVPA analysis did not end with a response and has no special signiﬁcance, we did not estimate a ﬂat duration from the last bump to the end of the interval.  Estimating an n-bump HSMM also requires estimating the topographical distributions of the n multidimensional bumps.  These are intended to capture signals, present in the 10 PCA dimensions, during the 50 ms windows where bumps are centered.  A bump is deﬁned as a 2-dimensional matrix of values Bij where j indexes the 5 samples that make up the 50 ms bump and i indexes the 10 PCA dimensions.  The bump values are calculated as Bij = Pj*Mi where Pj are the 5 sample weights (i. e. , 0. 309, 0. 809, 1. 000, 0. 809, and 0. 309) that describe the shape of a half-sine and Mi are the 10 PCA magnitudes for bump i.  The values of Pj are ﬁxed based on the half-sine shape, and the values of Mi are estimated for each bump.  To summarize, ﬁnding n bumps requires estimating n scale parameters for the gamma distributions that characterize the durations of the ﬂats that precede each bump, and 10 x n magnitudes Mi to capture the observed PCA scores during the 50 ms windows that each bumpThe likelihood of a set of ﬂat durations (t1, t2, .  .  . tn) during a trial.  The ﬁrst inner product in the equation describes the likelihoods of the ﬂat durations based on the gamma distributions they are drawn from.  HSMM-MVPA estimates the scale parameter (bk) for each gamma distribution.  The second inner product in the equation describes the likelihoods of the scores along each of the 10 PCA dimensions.  These are derived from the sum of the squared deviations between the observed PCA scores and the model scores, which are zero during the ﬂats and non-zero during the bumps (Anderson et al. , 2016).  The probability of the data in a trial is the sum of the probabilities of all possible placements of bumps within the trial, each calculated as above.  The HSMM-MVPA estimates parameters (tn stage durations and Mn bump topographies) that maximize the likelihood of the data over all trials of the experiment.  The HSMM uses an iterative expectation maximization algorithm (Dempster, Laird, & Rubin, 1977).  The dynamic programming techniques associated with the HSMM make tractable the computation of probabilities of the very large number of ways of partitioning each trial into bumps and ﬂats (Yu, 2010).  When the iterative algorithm converges on a set of parameters than maximize the probability of the data, the algorithm also produces estimates of the probabilities that each bump occurred at each sample of each trial.  2. 5.  Comparison of neural processing to RTs.  HSMM-MVPA returns a sequence of bumps that appear in the EEG for each trial.  The bumps come after ﬂats, whose durations vary across trials according to gamma distributions with scale parameters estimated by the HSMM.  Because the ﬂat durations vary across trials, they can be used to create a predictive model of RTs.  We used R (R Core Team, 2016) and lme4 (Bates, Maechler, Bolker, & Walker, 2015) to perform a linear mixed effects analysis of the relationship between the trial-level bump latencies and RTs (Saville et al. , 2015).  If the cognitive processes reﬂected in a bump are needed to respond, we expected that inclusion of the time preceding that bump (i. e. , the duration of the ﬂat) would improve the predictive model of RTs.  We compared the predictive model based on HSMM-MVPA with two alternate techniques commonly used to quantify P3b latency.  peak picking and template matching (Woody, 1967).  Following Ja´skowski and Verleger (2000), we applied a 3. 5 Hz low-pass ﬁlter to the single-trial data.  In the case of peak picking, we quantiﬁed P3b latency as the moment of peak amplitude at Pz.  In the case of template matching, we generated a positive half-sinusoid of 300-ms length.  We calculated the cross-covariance between the template and the signal during 300 ms time windows across every trial, and quantiﬁed the P3b latency as the center of the window that maximally covaried with the template.  We then computed a new template using the average of the observed data from the identiﬁed windows, and iterated on the procedure until the template converged on a stable average.  For both peak picking and template matching, we used linear mixed effects models to examine the relationship between P3b latencies and RTs.  3.  Behavioral results.  3. 1.  Task data.  Responses in the PVT are often divided into three categories.  false starts occur before or within 150 ms of counter onset.  alert responses occur from 150 ms to 500 ms after counter onset.  and lapses occur more than 500 ms after counter onset.  Table 1 shows the distribution of response types along with the mean duration of alert responses.  Alert RTs and number of lapses were comparable to PVT results obtained elsewhere with well-rested participants (for reviews, see Basner & Dinges, 2011.  Lim & Dinges, 2008).  In the 3-Stimulus Task, participants were instructed to respond to targets, and to ignore non-target and standard distractors.  Table 1 shows the percentage of hits and false alarms, along with the mean duration of hits.  Although false alarms were infrequent, participants reliably responded to more non-target than standard distractors, t(27) = 3. 79, p < 0. 001.  Mean RTs, hit rates, and the relative frequencies of false alarms were consistent with outcomes from other studies of the 3-Stimulus Task that used visual stimuli and were of comparable difﬁculty (Comerchero & Polich, 1999.  Demiralp et al. , 2001).  In the Radar Task, participants were instructed to respond to critical events and to ignore non-critical events.  Table 1 shows the percentage of hits and false alarms, along with the mean duration of hits averaged across the entire experiment.  Mean hit rates across the 40 min session were comparable to those previously reported (Hitchcock et al. , 1999).  3. 2.  Between-task comparisons.  We restricted analyses to 26 participants with complete data from all tasks.  Responses were faster in the PVT than in the 3-Stimulus Task (t(25) = 19. 2, p < 0. 001) and the Radar Task (t(25) = 21. 2, p < 0. 001), and responses were faster in the 3-Stimulus Task than in the Radar Task (t(25) = 11. 0, p < 0. 001).  Hit rate was higher in the 3-Stimulus Task than in the Radar Task (t(25) = 5. 24, p < 0. 001), and false alarm rate was lower (t(25) = 2. 77, p < 0. 05).  Mean RTs from the 26 participants were moderately correlated pairwise between the tasks (ranging from r = 0. 18 to 0. 53), as were hit rates and false alarms between the 3-Stimulus and Radar Tasks (r = 0. 30 and 0. 10, respectively).  PVT and the 3-Stimulus Task (t(25) = 1. 81, p < 0. 1).  We also compared the peak latencies of the P3b.  Peak latency occurred later in the Radar Task than in the PVT (t(25) = 4. 64, p < 0. 001) and the 3Stimulus Task (t(25] = 4. 60, p < 0. 001), and was similar between the PVT and the 3-Stimlus Task (t(25) = 1. 09, p > 0. 2).  The peak latency trends are only partially consistent with the behavioral results – participants responded slower in the 3-Stimulus Task than in the PVT, yet P3b peak latencies did not differ between the two tasks.  P3b peak amplitudes from the 26 participants were moderately correlated pairwise between tasks (PVT and 3-Stimulus Task.  r = 0. 49.  PVT and Radar Task.  r = 0. 23.  3-Stimulus Task and Radar Task.  r = 0. 21), whereas peak latencies were not (all r < 0. 05).  4.  ERP results.  4. 1.  Task data.  Fig.  4 shows waveforms from the PVT time-locked to the onset of the visual counter.  Mean amplitude of the waveforms from 250 to 500 ms varied by region, F(2,56) = 45. 6, p < 0. 001.  Voltages were most positive over the parietal region (Table 2).  For each participant, we treated peak latency of the P3b as the time of the maximum voltage in the averaged waveform over the parietal region from 250 to 800 ms (the complete range of the time windows used across the three tasks).  On average, the P3b peaked at 429 ± 25 ms.  Fig.  4 also shows waveforms from the 3-Stimulus Task timelocked to the onset of targets, non-target distractors, and standard distractors.  A 3 (region) by 3 (stimulus type) repeated measures ANOVA on mean amplitude from 350 to 500 ms revealed main effects of region, F(2, 54) = 41. 6, p < 0. 001, and stimulus type, F(2, 54) = 24. 5, p < 0. 001.  The interaction between region and stimulus type was also signiﬁcant, F(4, 108) = 38. 7, p < 0. 001.  The P3 to targets (i. e. , the P3b) had a parietal maximum, whereas the P3 to non-target distractors (i. e. , the P3a) was more centrally distributed (Table 2).  Standard distractors did not produce a P3.  The P3b during target trials peaked at 458 ± 16 ms.  Finally, Fig.  4 shows waveforms from the Radar Task timelocked to the onset of critical and non-critical events.  A 3 (region) by 2 (stimulus type) repeated measures ANOVA on mean amplitude from 450 to 800 ms revealed main effects of region, F(2, 54) = 8. 329, p < 0. 001, and stimulus type, F(1, 27) = 17. 8, p < 0. 001.  The interaction between region and stimulus type was also signiﬁcant, F(2, 54) = 38. 6, p < 0. 001.  The P3 had a parietal maximum and was greater for critical versus non-critical events (Table 2).  The P3b to critical events peaked at 611 ± 30 ms.  4. 2.  Between-task comparison.  We compared the amplitudes of the P3b evoked by the visual millisecond counter in the PVT, targets in the 3-Stimulus Task, and critical events in the Radar Task for the 26 participants with complete data.  P3b amplitude over the parietal area was smaller in the Radar Task than in the PVT (t(25) = 3. 82, p < 0. 001) and the 3Stimulus Task (t(25) = 6. 82, p < 0. 001), and was similar between the 5.  HSMM-MVPA results.  5. 1.  Psychomotor vigilance task.  We compared how well two- and three-bump HSMMs accounted for the EEG data from the PVT.  We ﬁt each HSMM to n-1 participants’ data and used the parameterized model to predict the remaining participant’s data (leave-one-out cross validation, or LOOCV).  Adding more bumps involves estimating more parameters.  As such, log-likelihoods based on ﬁt always increase from two to three bumps, but log-likelihoods based on LOOCV only increase if the additional bump captures structure in the data that generalizes to other participants.  Table 3 shows the average log-likelihood values per participant and trial based on LOOCV.  The addition of a third bump improved out-of-sample prediction for most participants (p < 0. 05 by a two-tailed sign test).  Fig.  5 shows the bump topographies along with their mean latencies from the PVT (upper-left panel).  The third bump corresponds to the P3b with its posterior distribution and late onset.  The second bump resembles the N2b, an anterior negativity that precedes the P3 and is sensitive to many of the same experimental factors (Folstein & Van Petten, 2008).  Activity related to the second and third bumps is visible in the ERP waveforms at the corresponding latencies (Fig.  4).  The ﬁrst bump had a short latency and negative polarity over the parietal scalp, yet the ERPs contain no evidence of such an early deﬂection.  This dissociation relates to trial-by-trial variability in the latency of the ﬁrst bump.  Uncertainty about the latency of a bump within a trial is represented by a probability distribution with values corresponding to the likelihood that the bump is centered at each sample.  The latency of a bump in a trial is calculated as the sum of the time points multiplied by the probability that the bump is centered at each sample – that is, a weighted average of the timeWe divided trials into two bins according to the estimated latency of the ﬁrst bump using a median split.  Trials in both bins had an early negative-going deﬂection followed by a positive peak (Fig.  6, left).  Further, the waveforms appeared to contain an oscillation that originated during the prestimulus interval and extended through the ﬁrst bump.  We ﬁt sine waves to averaged data from the two sets of trials from −200 ms to the time where voltages exceeded zero following the ﬁrst bump (90 ms for trials where the bump occurred early and 150 ms for trials where the bump occurred late).  The amplitudes (1. 00 (cid. 2)V versus 1. 17 (cid. 2)V) and frequencies (9. 6 Hz versus 9. 2 Hz) of the ﬁtted sine waves were nearly identical, but the phase of the sine wave for trials where the bump occurred late was shifted to the right by 56 ms.  Consequently, the positive and negative cycles of the two groups of waveforms almost perfectly canceled out in the average data.  The separation of trials into two bins is arbitrary.  the phase of the oscillation varied continuously between trials, and because the oscillation was not stimulus locked, the positive and negative cycles averaged to zero across trials.  Makeig et al.  (2002) proposed that the N1 arises from alpha ringing (8–12 Hz) over the parietal scalp during visual attention tasks, a point we return to in the discussion.  5. 2.  3-Stimulus task.  The 3-Stimulus Task included a mixture of trial types that could contain different numbers of bumps.  for example, we expected bumps corresponding to the P3 for targets and non-target distractors, but not for standard distractors.  Trial types could also contain bumps with different topographies.  for example, we expected a more posterior bump for targets (P3b), and a more central bump for non-target distractors (P3a).  To test for these differences, we ﬁt 2- and 3-bump HSMMs separately to data from each condition.  We constrained the latencies of the ﬁrst and second bumps to be shared across conditions, and allowed the latencies of the third bump and the topographies of all bumps to vary.  Table 3 shows the average log-likelihood values per trial and participant based on LOOCV.  The addition of a third bump improved out of sample prediction for a majority of participants in target trials and non-target distractor trials (p < 0. 05 by a two-tailed sign test), but not in standard distractor trials (p > 0. 3 by a two-tailed sign test).  Fig.  5 shows the 3-bump HSMMs for targets and non-target distractors, and the 2-bump HSMM for standard distractors.  We calculated the voltages over the frontal, central, and parietal regions at the peak of the third bump for targets and non-target distractors.  The bump had a more posterior distribution for targets than for non-target distractors, reﬂected in a signiﬁcant condition-bylocation interaction, F(2, 54) = 40. 7, p < 0. 0001.  This is consistent with the centrally-distributed P3a for non-target distractors and the parietal P3b for targets in the ERP waveforms (Fig.  4).  The topographical distributions of the second and third bumps in target trials of the 3-Stimulus Task closely resembled the corresponding bumps in the PVT (Table 4).  This, paired with their consistent latencies caused us to interpret them as the N2/P3 complex in the 3-Stimulus Task as well.  Likewise, the topographical distribution of the ﬁrst bump in the 3-Stimulus task closely resembled the corresponding bump in the PVT (Table 4).  Its time course and distribution are consistent with the posterior N1, a component evoked by the presentation of a visual stimulus at an attended location during a task that requires discrimination judgments (Hopf, Vogel, Woodman, Heinze, & Luck, 2002.  Makeig et al. , 2002.  Vogel & Luck, 2000).  Although the ﬁrst bump in the PVT closely resembled the ﬁrst bump in the 3-Stimulus Task (Table 4), it came about 100 ms earlier in the PVT.  If the ﬁrst bump in the PVT truly reﬂected an alpha oscillation, as suggested by Fig.  6, then a brain state with a very similar topographic distribution would come 100 ms later.  Relatedly, if the ﬁrst bump in the 3-Stimulus Task reﬂected a continuation of this oscillation, a brain state with a very similar topographic distribution would come 100 ms earlier.  To examine this possibility, we ﬁt another HSMM to target trials from the 3-Stimulus Task while constraining the ﬁrst bump to have a mean latency of 80 ms.  The timing and topography of the second and third bumps in the constrained HSMM matched bumps from the original HSMM.  The topography of the ﬁrst bump in the constrained model was nearly identical to the ﬁrst bump in the PVT (r = 0. 98, MSE = 4. 1).  We binned target trials in the 3-Stimulus task according to the estimated latencies of the constrained ﬁrst bump and observed an oscillation extending from −200 ms to just beyond the bump (Fig.  6, middle).  The amplitudes (1. 08 (cid. 2)V versus 1. 04 (cid. 2)V) and frequencies (8. 7 Hz versus 8. 0 Hz) of ﬁtted sine waves to the data were similar to one another, but the phase of the sine wave for trials with later bump onset was shifted to the right by 50 ms.  Consequently, as in the PVT, the positive and negative cycles of the oscillation averaged to zero across trials.  Note, HSMM-MVPA did initially detect a bump at 80 ms in the 3-Stimulus Task.  The oscillation had larger amplitude and/or phase synchronization at 150 ms, causing HSMM-MVPA to place the ﬁrst bump at that time instead.  5. 3.  Radar task.  The Radar Task contained a mixture of trial types that could differ in terms of number and topography of bumps.  To examine these differences, we ﬁt 2- and 3-bump HSMMs to data from critical and non-critical trials.  We constrained the latencies of the ﬁrst and second bumps to be the same across conditions, and allowed the latencies of the third bump and the topographies of all bumps to vary.  Table 3 shows the average log-likelihood values per trial and participant based on LOOCV.  The addition of a third bump improved out of sample prediction for a majority of participants in critical trials only (p < 0. 05 by a two-tailed sign test). 4 Fig.  5 shows the 3-bump HSMM for critical trials, and the 2bump HSMM for non-critical trials.  The ﬁrst and third bumps in critical trials of the Radar Task closely resembled the corresponding bumps in target trials of the 3-Stimulus Task (Table 5).  This paired with their similar latencies caused us to interpret them as the N1 and P3b in the Radar Task as well.  The second bump in the Radar Task was most similar to the ﬁrst bump in the 3-Stimulus Task (Table 5).  The apparent difference relates to the fact that the P3b appeared earlier in the 3-Stimulus Task, causing it to overlap with the second bump there but not in the Radar Task.  This difference aside, we interpret the second bump in the Radar Task as the N2 asTo determine whether a posterior oscillation beginning during the prestimulus interval was present in the Radar Task, as in the PVT and 3-Stimulus Task, we ﬁt another HSMM to critical trials that constrained the ﬁrst bump to have a mean latency of 80 ms.  The topography of the ﬁrst bump in the constrained model was very similar to the ﬁrst bump in the PVT (r = 0. 90, MSE = 1. 7).  We binned critical event trials in the Radar Task according to the estimated latencies of the constrained ﬁrst bump and observed an oscillation extending from −200 ms to just beyond the bump (Fig.  6, right).  The amplitudes (1. 00 (cid. 2)V versus 0. 90 (cid. 2)V) and frequencies (10. 0 Hz versus 8. 8 Hz) of ﬁtted sine waves to the data were similar to one another, but the phase of the sine wave for trials with later bump onset was shifted to the right by 30 ms.  Consequently, as in the other two tasks, the positive and negative phases of the oscillation averaged to zero across trials.  5. 4.  Comparison of neural processing to response latencies.  The latencies of the bumps vary on a trial-by-trial basis.  To determine which bumps relate most to RTs in the three tasks, we compared RTs and bump latencies from 2577 trials in the PVT, 926 target trials in the 3-Stimulus Task, and 2124 critical event trials in the Radar Task (Fig.  7).  In the PVT, RTs were most strongly correlated with the latencies of Bump 2, which peaked 39 ms (±6 ms) before responses on average. 5 RTs also correlated with the latencies of Bumps 1 and 3.  In the case of Bump 3, the correlation arose because Bumps 1 and 2 impacted the timing of responses as well as cumulative time until Bump 3.  In contrast to the PVT, RTs were most strongly correlated with the latencies of Bump 3 in the 3-Stimulus Task and the Radar Task (Fig.  7). 6 Bump 3 peaked 11 ms (±8 ms) after the response in the 3-Stimulus Task on average, and 16 ms (±11 ms) after the response in the Radar Task. 7 We performed a linear mixed effects analysis on the relationship between bump latencies and RTs.  To do so, we calculated the elapsed time before the peak of Bump 1, the elapsed time between the peaks of Bumps 1 and 2, and the elapsed time between the peaks of Bumps 2 and 3.  We treated these as ﬁxed effects and estimated a random intercept for each participant.  We added factors in a stepwise manner beginning from a null model with a random intercept only, and used the likelihood ratio test to compare full and reduced models.  If the mental processes reﬂected by each subsequent bump are necessary for responding, inclusion of the bump in the mixed effects model should account for additional variance in RTs.  As shown in Table 6, the likelihood ratio test justiﬁed the inclusion of Bump 1 (␹1 = 209. 5) and Bump 2 (␹1 = 201. 7), but not of Bump 3 (␹1 = 0. 8, p > 0. 3) in the PVT.  Conversely, the likelihood ratio test justiﬁed the inclusion of Bumps 1, 2, and 3 in the 3-Stimulus Task (␹1 = 177. 4,  (␹1 = 96. 0,  ␹1 = 10. 0,  ␹1 = 303. 5).  ␹1 = 18. 1,  ␹1 = 222. 3), as well as in the Radar Task.  P3b latency has been shown to relate to RTs in choice reaction time tasks (Kutas et al. , 1977.  Ritter, Simson, & Vaughan, 1983).  To determine whether this was the case in our three tasks, we identiﬁed the latency of the P3b on a trial-by-trial basis using peak latency and a template matching procedure as described in the methods section.  In the PVT, a simple detection task, there was a weak relationship between RTs and the P3b, measured using peak latency (r = 0. 09) or template matching (r = 0. 18).  In the 3-Stimulus and Radar Tasks, which are choice reaction-time tasks, there was a stronger relationship between RTs and the P3b, measured using peak latency (3-Stimulus.  r = 0. 30.  Radar.  r = 0. 05) and template matching (3-Stimulus.  r = 0. 29.  Radar.  r = 0. 23).  We performed two additional linear mixed effects analyses toexamine the relationship between P3b latency, measured usingpeak latency or template matching, and RTs.  In both analyses,we treated P3b latency as a fixed effect and estimated a ran-dom intercept for each participant (Table 6).  In the PVT, includingP3b latency produced an improvement beyond the null model(peak picking.  1= 33. 3, p < 0. 0001.  template matching.  1= 60. 4,p < 0. 0001).  In the 3-Stimulus Task, including P3b latency alsoproduced an improvement beyond the null model (peak pick-ing.  1= 92. 9, p < 0. 0001.  template matching.  1= 74. 0, p < 0. 0001). Finally, in the Radar Task, including P3b latency measured withtemplate matching, but not peak picking, produced an improvement beyond the null model (peak picking.  1= 0. 7, ns.  templatematching.  1= 120. 6, p < 0. 0001).  <Conclusion> 6.  General discussion.  The P3b is among the most widely studied components in ERP research.  In this paper, we used HSMM-MVPA to analyze data from three variants of the oddball paradigm known to evoke the P3b.  We asked whether HSMM-MVPA would reveal a stage in each task corresponding to the P3b, and whether the stage’s latency would relate to response times.  The onset of the millisecond counter in the PVT produced a bump with a topographical distribution and time course resembling the P3b, as did targets in the 3-Stimulus Task and critical signals in the Radar Task.  The latencies of the P3b differed across trial and correlated with RTs in the 3-Stimulus and Radar Tasks, but not in the PVT.  We discuss the implications of these ﬁndings with respect to the functional signiﬁcance of the P3b and the use of HSMM-MVPA for mental chronometry in turn.  6. 1.  Functional signiﬁcance of the P3b.  A long standing theory is that the P3b reﬂects context updating (Donchin, 1981.  Polich, 2007).  Incoming stimuli are attended to and compared against a stimulus representation in memory.  If no change is detected, the stimulus context is maintained and only sensory components are evoked.  If change is detected, however, the stimulus context is updated and a P3b is evoked, reﬂecting the corresponding neural activity following the earlier sensory components.  This account explains why manipulations that exacerbate sensory processing and prolong stimulus categorization delay P3b latencies.  The question of how the P3b relates to responding remains controversial, however.  According to the strategic view, the P3b reﬂects an overarching process not directly relevant to immediate responses (Donchin & Coles, 1988).  According to the tactical view, the P3b bridges stimulus categorization and response preparation (Verleger et al. , in press.  Verleger et al. , 2005).  Both accounts ascribe the P3b a role in stimulus processing.  They differ, however, in whether the P3b relates strategically to future behavior or tactically to trial-level responses.  In the 3-Stimulus and Radar Tasks, which both required categorizing the stimulus before responding, the P3b bump peaked with responses and correlated with RTs.  Critically, the latency of the P3b bump varied across repeated presentations of the same stimuli and was predictive of RTs.  This strongly suggests that the process reﬂected by the P3b bump contributes tactically to triallevel responses in the 3-Stimulus Task and the Radar Task.  In the PVT, which required simple detection, the P3b came about 150 ms after responses and did not correlate with RTs after controlling for the latencies of earlier bumps.  This indicates that the process reﬂected by the P3b bump did not contribute tactically to triallevel responses in the PVT.  The central ﬁnding pertaining to the P3b bump, and the P3b itself, is that it plays a tactical role in tasks that require stimulus categorization, but not in tasks that require simple detection.  Ouyang et al.  (2011, 2013) recently proposed a novel technique called residue iteration decomposition (RIDE) to separate the EEG into stimulus-locked, response-locked, and central component clusters.  The technique involves iteratively estimating the latencies of central clusters during single trials, and iteratively improving estimates of the stimulus-locked, central, and response-locked components.  Central components bridge stimulus- and responserelated processes.  Verleger et al. 
1.  Introduction.  The P3 is among the most widely studied components in eventrelated potential (ERP) research.  It comprises a family of brain potentials including the novelty P3 and the target P3 (Sutton, Braren, Zubin, & John, 1965.  for reviews, see Donchin & Coles, 1988 .  Picton, 1992.  Polich, 2007).  The novelty P3, or P3a, is a frontocentral positivity evoked by the onset of novel, non-target stimuli.  The target P3, or P3b, has a more posterior distribution and is evoked by the onset of task-relevant stimuli that require some type of mental or motor response.  In this paper, we focus on the P3b and its relationship with the timing and types of mental events culminating in behavioral responses.  A long held view is that the P3b reﬂects context updating.  when an incoming stimulus deviates from the representation maintained in working memory, the representation is updated and a P3b is generated (Donchin & Coles, 1988.  Donchin, 1981.  Polich, 2007.  but see Verleger, 1988).  Implicit in this and other theories is the idea that the P3b is only evoked once a stimulus has been categorized.  According to this stimulus-evaluation account, P3b latency can be used to divide processing into two general stages – stimulusrelated and response-related.  P3b latency is strongly affected by the duration of stimulus-related processing.  Many studies have conﬁrmed that P3b latency increases when stimulus categorization is difﬁcult (Coles, Gratton, Bashore, Eriksen, & Donchin, 1985.  Kutas, McCarthy, & Donchin, 1977.  Magliero, Bashore, Coles, & Donchin, 1984.  Twomey, Murphy, Kelly, & O’Connell, 2015).  Alternatively, P3b latency is weakly affected by manipulations that prolong response planning, particularly if there is little temporal overlap between stimulus categorization and motor preparation.  The relationship between the P3b and responding remains controversial, however.  Donchin and Coles ascribed the P3b (i. e. , the P300) a role in strategic processing (1988).  They proposed that the P3b is not involved in immediate responding per se, but rather in some overarching process that operates in parallel or afterwards.  For example, stimulus categorization could inﬂuence future behavior by causing strategy shifts or changes in cognitive control.  In support of this view, the P3b sometimes follows the response, suggesting that it does not directly relate to responses (for a review, see Donchin & Coles, 1988).  Additionally, correlations between P3b latencies and response times (RTs) are sometimes weak or absent, reinforcing the idea that the P3b does not directly contribute to responses.  Other evidence indicates that the P3b plays a role in tactical processing, however (O’Connell et al. , 2012.  Verleger, Grauhan, & ´Smigasiewicz, in press.  Verleger, Ja´skowski, & Wascher, 2005.  for a review, see Nieuwenhuis, Aston-Jones, & Cohen, 2005).  By this view, the P3b bridges stimulus categorization and response preparation within trials.  In support of this view, many studies have found that the P3b precedes responses, and that P3b latencies correlate with RTs (for a review, see Verleger, 1997).  This suggests that responses depend on the mental process reﬂected in the P3b.  Building on these ﬁndings, O’Connell et al.  (2012) demonstrated that the P3b could be treated as a build-to-decision variable that peaked with behavioral responses in a range of tasks that varied stimulus contrast and modality.  Further evidence comes from studies that compare temporal synchronization of the P3b with stimulus onset and response commission.  Verleger et al.  (2005) compared the amplitudes of the P3b in stimulus-locked and response-locked waveforms.  They reasoned that if the P3b relates only to stimulus processing, it would be time-locked to stimulus onset and its amplitude would be largest in stimulus-locked waveforms.  Conversely, if the P3b signiﬁes the conclusion of stimulus processing and the organization of a response, its amplitude would be equal in stimulus-locked and response-locked waveforms.  P3b amplitude was, in fact, equal in stimulus-locked and response-locked waveforms, consistent with its role in tactical processing.  To summarize, the tactical and strategic views both assume a relationship between stimulus categorization and the P3b.  They differ, however, in whether they ascribe the P3b a role in immediate responses or future behavior.  Existing studies of the P3b latency are limited in key ways.  Some have found little to no relationship between P3b latencies and RTs despite the fact that the experimental manipulations would be expected to affect stimulus processing (for a review, see Verleger, 1997).  This may reﬂect shortcomings of the underlying stimulusevaluation account and the tactical view of the P3b, or limitations of the methods used to measure P3b latency.  Additionally, the relationship between P3b latencies and RTs is typically assessed by comparing their averages in different conditions (McCarthy & Donchin, 1981.  Ritter, Simson, Vaughan, & Macht, 1982), or by binning trials according to RTs and comparing average P3b latencies from trials with fast versus slow responses (Friedman, 1984.  Roth, Ford, & Kopell, 1978).  Both approaches ignore information about trial-by-trial variability in P3b latencies and RTs.  The peak latency of the P3b varies within individuals on the order of tens of milliseconds (Nishida, Nakamura, Suwazono, Honda, & Shibasaki, 1997.  Pfefferbaum, Ford, Roth, & Kopell, 1980a,b), raising the possibility that trial-by-trial ﬂuctuations in P3b latencies relate to changes in RTs (but see Ramchurn, de Fockert, Mason, Darling, & Bunce, 2014 for an alternate view).  The majority of studies comparing P3b latencies to RTs use tasks where stimuli must be categorized before responding.  Simple detection tasks, which require merely detecting the onset of a single repeating target stimulus, also evoke a P3b (Mertens & Polich, 1997.  Polich & Heine, 1996.  Polich, Eischen, & Collins, 1994).  The ﬁnding that a continuously repeating target produces a P3b may seem to undermine the idea that the component reﬂects context updating.  However, given the ancillary assumption that the representation of context held in memory decays over time, the re-occurrence of the target may serve to restore the representation (Gonsalvez, Barry, Rushby, & Polich, 2007).  Even if such an update is obligatory, it is not needed to respond in simple detection tasks.  If the P3b occurs after stimulus categorization is complete, but initial encoding is all that is needed to respond, the P3b may come after responses and be less strongly associated with them in simple detection versus choice RT tasks.  In this paper, we present a novel method for detecting significant events in the EEG signal.  These events relate to early visual components, and later cognitive components such as the P3b.  We apply the method to data from three paradigms commonly used to study the P3b in order to understand how the component and its relationship to behavioral responses differs among tasks.  We describe the P3b task variants and the analytical technique next.  1. 1.  P3b task variations.  The P3b is robustly evoked in three variants of the oddball paradigm.  In the single stimulus variant, targets are presented after unpredictable temporal delays (Mertens & Polich, 1997.  Polich & Heine, 1996.  Polich et al. , 1994).  No other stimuli are shown, and participants are instructed to respond to targets.  In the two stimulus variant, target and standard distractor stimuli are presented (Duncan-Johnson & Donchin, 1977.  Squires, Squires, & Hillyard, 1975).  Target stimuli appear infrequently, and participants are instructed to respond to targets.  Finally, in the three stimulus variant, targets, standard distractors, and non-target distractors are presented (Comerchero & Polich, 1999.  Conroy & Polich, 2007).  Standard and non-target distractors differ in that non-target distractors are presented at the same (low) frequency as targets.  In all three tasks, targets produce a centroparietal positivity consistent with the P3b.  Non-target distractors, which appear infrequently in the three-stimulus paradigm, produce a more frontocentral P3a.  Finally, standard distractors produce little to no positive modulation during the time window of the P3.  Katayama and Polich (1996) recorded EEG from participants as they completed one-, two-, and three-stimulus oddball paradigms.  P3b peak amplitude was equivalent across tasks, while P3b peak latency was shorter in the one-stimulus oddball paradigm as compared to the two- and three-stimulus variants (see also, Walhovd & Fjell, 2001).  Within individuals, P3b amplitudes were correlated between all pairs of tasks, as were P3b latencies.  Other studies have also found that the topographical distribution of the P3b is consistent across one- and two-stimulus oddball tasks (Croft, Gonsalvez, Gabriel, & Barry, 2003), as are the neural generators inferred using source modeling (Tarkka & Stokic, 1998).  1. 2.  HSMM-MVPA.  Inspired in part by ERP-based mental chronometry pioneered with the P3b (Duncan-Johnson, 1981.  Kutas et al. , 1977.  Meyer, Osman, Irwin, & Yantis, 1988.  Pfefferbaum et al. , 1980a,b), we have developed a novel method for decomposing the EEG signal into a sequence of processing stages.  The method reveals information about the number and latencies of processing stages in a task, along with their associated scalp distributions (Anderson, Zhang, Borst, & Walsh, 2016.  Zhang, Walsh, & Anderson, in press).  Here, we apply the method to three paradigms known to evoke the P3b to better understand the types and timing of mental operations that occur in each.  The standard approach to analyzing EEG data in the time domain is to segment the continuous recording, align the segments to observable events such as the onset of a stimulus or the commission of a response, and average the signal across the segments to create event-related potentials, or ERPs (Luck, 2014.  Vaughan, 1969.  Walter, Cooper, Aldridge, McCallum, & Winter, 1964).  ERPs contain characteristic sequences of negative- and positive-going deﬂections, including the P3b.  Comparison of the ERPs obtained for different conditions of an experiment can reveal whether, when, and for how long a manipulation impacted mental processing.  Although this approach to EEG analysis has been extremely informative, it has two important limitations.  First, neural signals that are only weakly locked to observable events are attenuated in average waveforms because they occur at different times during different trials.  This is especially problematic for later signals that reﬂect variability from the durations of processes that precede them.  Second, ERPs represent average activity and discard information about differences in when various components appeared within each trial.  Trial-by-trial variability in component latencies could be informative with respect to understanding variability in overt behavioral responses.  To overcome these limitations, we developed a technique for applying hidden semi-Markov models and multivariate pattern analysis to EEG data (HSMM-MVPA.  Anderson et al. , 2016.  Zhang et al. , in press).  The method assumes that in the absence of taskrelated processing, the background EEG can be modeled as ongoing sinusoidal noise (Fig.  1, left), the amplitude of which varies by frequency according to a known power spectrum (Yeung, Bogacz, Holroyd, Nieuwenhuis, & Cohen, 2007).  Stimulus onset initiates task-related processing, and transitions from one cognitive stage to the next are marked by the superposition of bumps on the background EEG.  A bump is a multidimensional distribution of scalp activity, and is modeled as a half cycle of a 10 Hz sine wave (Fig.  1, middle).  The bump rises, peaks, and falls over 50 ms.  The recorded EEG contains ongoing sinusoidal noise along with the signal from one or more bumps (Fig.  1, right).  This conceptual model is consistent with the classical theory of ERP generation (Yeung et al. , 2007), in which ERPs arises from the addition of event-locked signals to the background EEG.  Others have argued that ERPs arise when an event causes the phase of an oscillation in a certain frequency band to be reset, causing its peaks and troughs to be aligned across trials (Basar, 1980).  Although these theories have different conceptual bases, both predict the appearance of phasic bumps time-locked to experiment events (Yeung, Bogacz, Holroyd, & Cohen, 2004, 2007) The intervals between bumps, referred to as ﬂats, contain only sinusoidal noise with mean zero.  The durations of ﬂats differ on a trial-by-trial basis, reﬂecting variability in the latencies of the underlying mental processes.  Flat durations are modeled as random variables drawn from gamma distributions (Fig.  2).  The HSMM estimates when bumps occurred during each trial, and the MVPA estimates the multidimensional scalp activity associated with a bump.  Using HSMM-MVPA, it is possible to infer the number, timing, and topography of bumps that maximize the likelihood of the EEG data.  We previously applied HSMM-MVPA to two studies of associative recognition and a study using the Sternberg Task (Anderson et al. , 2016.  Zhang et al. , in press).  In all of those cases, a computational cognitive model for the task had already been created using the integrated cognitive architecture ACT-R (Anderson, 2007).  The models contained predeﬁned numbers of processing stages, and speciﬁed how the durations of stages were impacted by the various experimental manipulations.  The main contribution of HSMMMVPA was to test whether the numbers and durations of stages inferred from the EEG were consistent with the computational models.  This constitutes a top-down application of HSMM-MVPA for testing existing theories.  HSMM-MVPA can also be used in a bottom-up manner to infer the number and durations of processing stages directly from the EEG.  We adopt the bottom-up approach in this paper.  1. 3.  Overview of current experiments.  We recorded EEG from participants as they performed three tasks.  the Psychomotor Vigilance Task (PVT.  Dinges & Powell, 1985), the Hitchcock Radar Task (Hitchcock, Dember, Warm, Moroney, & See, 1999), and the 3-Stimulus Task (Comerchero & Polich, 1999).  In the PVT, participants monitored the screen for the onset of a millisecond counter.  They responded when the counter appeared.  In the Hitchcock Radar Task, participants saw frequent non-critical signals and infrequent critical signals.  They responded to critical signals only.  Finally, in the 3-Stimulus Task, participants saw frequent distractors, rare distractors, and targets.  They responded to targets only.  The particular tasks were selected for reasons unrelated to the current paper.  Yet they exemplify the one, two-, and three-stimulus oddball paradigms commonly used to study the P3b.  We applied HSMM-MVPA to EEG data from these tasks to address two questions.  First, does HSMM-MVPA reveal a stage with a bump corresponding to the P3b.  Based on the existing literature, we expected to see such a bump after counter onset in the PVT, after critical signals in the Radar Task, and after targets in the 3-Stimulus Task.  Second, is the latency of the P3b stage associated with RTs.  Both the Radar and 3-Stimulus Task require categorizing stimuli before responding.  As such, we expected responses to follow, and be synchronized with, the P3b stage in trials of those tasks.  The PVT only requires detecting a stimulus before responding.  Consequently, it was unclear whether responses would precede or follow the P3b in the PVT, and whether RTs would relate to P3b latencies.  <Middle> 2.  Methods.  2. 1.  Participants.  Thirty individuals from the University of Dayton community participated in a single two hour session for monetary compensation (10 men and 20 women, ages ranging from 18 to 36 with a mean of 22. 7).  27 were right-handed.  None reported a history of neurological impairment.  2. 2.  Tasks.  Each participant completed three tasks.  the Psychomotor Vigilance Task (PVT), the 3-Stimulus Task, and the Radar Task.  The tasks were separated by ﬁve-minute breaks.  Because the Radar Task was longest, all participants completed that task ﬁrst, followed by the PVT and the 3-Stimulus Task.  We describe the tasks, and later the results, in order of task difﬁculty as inferred from RTs.  Responses were fastest in PVT, followed by the 3-Stimulus Task, and the Radar2. 2. 1.  Psychomotor vigilance task.  The PVT is frequently used in sleep research (Dinges & Powell, 1985.  Lim & Dinges, 2008).  Participants monitored a display for the onset of a visual millisecond counter within a box that was 5 cm wide by 1 cm high.  The counter started from zero and continuously incremented until the participant responded, or until 30 s passed.  Elapsed time remained on the screen for 1 s after the participant responded and served as performance feedback.  The next trial began from 1 to 9 s after feedback was extinguished.  The cumulative duration of the inter-trial interval (including 1 s for feedback) was randomly drawn from a uniform integer distribution ranging from 2 to 10 s.  The counter and feedback appeared in white against a black background.  Participants were instructed to respond as quickly as possible, but to avoid responding before the stimulus appeared.  They pressed the “J” key on a standard keyboard using their right index ﬁnger.  Participants were given 1 min of practice on the PVT.  Following a short break, they performed the task continuously for 10 min.  2. 2. 2.  3-Stimulus task.  The 3-Stimulus Task was based on the visual condition of two prior studies (Comerchero & Polich, 1999.  Conroy & Polich, 2007).  In each trial, participants viewed a target, a non-target distractor, or a standard distractor.  Targets and non-target distractors each appeared in 10% of trials, and standard distractors appeared in the remaining 80% of trials.  The target was a large circle (2. 5 cm diameter), the non-target distractor was a large square (2. 5 cm height), and the standard distractor was a small circle (1. 6 cm diameter).  Stimuli were presented in blue against a black background.  A stimulus appeared once every 2 s, and remained on the screen for 75 ms.  Participants were instructed to respond to targets and to ignore non-target and standard distractors.  They pressed the “J” key on a standard keyboard using their right index ﬁnger.  Participants were given 20 practice trials.  Following a short break, they completed 4 blocks of 90 trials.  After each block, they received feedback about the percentages of targets detected (i. e. , hits), and non-target and standard distractors ignored (i. e. , correct rejects).  2. 2. 3.  Radar task.  The Radar Task was based on a study by Hitchcock et al.  (1999).  A stimulus display with a ﬁlled central circle (1. 6 cm diameter) and three concentric rings (2. 8 cm, 3. 9 cm, and 5. 1 cm diameters) appeared in each trial (Fig.  3).  Two line segments (0. 15 cm wide by 1. 4 cm long) were superimposed on the concentric rings.  Participants were told that the ﬁlled circle nominally corresponds to a city, and the line segments to two jets.  They were instructed to respond if the two jets were on a collision path with one another (i. e. , the line segments were colinear).  Critical events occurred in 3. 3% (10 out of every 300) trials.  Stimulus displays were presented in white against a black background.  A new display appeared every 2 s and remained on the screen for 300 ms.  Participants were instructed to respond to critical events and to ignore non-critical events.  They pressed the “J” key on a standard keyboard using their right index ﬁnger.  Participants were given 200 practice trials.  During practice, they received feedback about the percentages of critical events detected and non-critical events ignored after every 50 trials.  Following a short break, they performed the task continuously for 40 min (1600 trials) without feedback or breaks.  2. 3.  EEG recording and analysis.  Stimuli were presented on a 60 Hz LCD monitor placed approximately 60 cm from participants.  The EEG was recorded from 64 Ag-AgCl sintered electrodes (10–20 system) using a Biosemi Active II System (BioSemi, Amsterdam, Netherlands).  Voltage offsets were reduced to 40 mV or less, and the resting EEG was checked for any problematic electrodes prior to recording. 1 The EEG was rereferenced online to the combined common mode sense (CMS) and driven right leg (DRL) circuit.  Electrodes were also placed on the right and left mastoids.  Scalp recordings were algebraically rereferenced ofﬂine to the average of the right and left mastoids.  The EEG signals were ﬁltered with a bandpass of 0. 1–70. 0 Hz and were digitized at 512 Hz.  The EEG recording was decomposed into independent components using the EEGLAB FastICA algorithm (Delorme & Makeig, 2004).  Components associated with eye blinks were automatically identiﬁed and projected out of the EEG recording.  Epochs of 1200 ms (including a 200 ms baseline) were then extracted from the continuous recording and corrected over the prestimulus interval.  Epochs containing voltages above +100  were excluded from further analysis.  One participant with less than 30% artifact free data was excluded from the PVT, two participants were excluded from the 3-Stimulus Task, and two participants were excluded from the Radar Task.  The P3b is typically deﬁned in terms of its topographical distribution along the midline and over the frontal, central, and parietal scalp (Comerchero & Polich, 1999.  Conroy & Polich, 2007).  Accordingly, we averaged across contiguous electrodes to create three regions.  a frontal region (AF3, Fpz, AFz, Fz, AF4), a central region (C1, FCz, Cz, CPz, C2), and a parietal region (P1, CPz, Pz, POz, P2).  P3b latency varies by task.  For the PVT, we analyzed waveforms evoked by the onset of the visual millisecond counter.  We quantiﬁed the P3b as mean voltage from 250 to 500 ms (Witkowski et al. , 2015).  For the 3-Stimulus Task, we compared waveforms evoked by the onset of targets, non-target distractors, and standard distractors.  We quantiﬁed the P3b as mean voltage from 350 to 500 ms (Comerchero & Polich, 1999).  Lastly, for the Radar Task, we analyzed waveforms evoked by the onset of critical and non-critical events.  Only one previous EEG study of the Radar Task has been published (Kamzanova, Kustubayeva, & Matthews, 2014), and that study did not analyze ERPs.  As such, the interval used to quantify the P3b (450–800 ms) in the Radar Task was based on visual inspection of the waveforms.  For all analyses involving factors with more than two levels, we adjusted the p values using the Greenhouse-Geisser correction.  2. 4.  HSMM-MVPA analysis.  HSMM-MVPA models the variability of endogenous ERP components that may otherwise be distorted or lost in average waveforms (Anderson et al. , 2016.  Zhang et al. , in press).  The method identiﬁes brief periods of activity characterized by distinctive patterns of voltages across the scalp called bumps.  Bumps occur at variable latencies in the single-trial EEG, and signify changes in information processing.  Bumps are separated by ﬂat periods where the mean of the ongoing sinusoidal noise is zero.  Flat durations vary by trial, and are treated as random variables drawn from gamma distributions.  The HSMM estimates the locations of bumps during each trial, and the MVPA estimates their scalp topographies.  The EEG data were pre-processed in the same manner as for the ERP analyses.  Two additional steps of dimensionality reduction were performed to increase the efﬁciency and tractability of HSMM-MVPA.  First, the data were interpolated and down-sampled to 100 Hz (i. e. , 10-ms samples).  Second, because signals from different EEG electrodes are highly inter-correlated, spatial PCA was performed and scores of the ﬁrst 10 PCA components were retained.  These accounted for 86% of variance in the EEG signal during the PVT, 85% of variance during the 3-Stimulus Task, and 83% variance during the Radar Task. 2 The PCA components were z-scored for each trial.  The ﬁnal data consisted of 10 orthogonal PCA components sampled every 10 ms and with constant mean and variability across trials.  HSMM-MVPA contains three ancillary assumptions.  First, bumps have a 50 ms duration (i. e. , 5 samples) and a half-sine shape.  The use of such narrow bumps promotes precision in the identiﬁcation of stage boundaries, and allows HSMM-MVPA to simultaneously identify components with power focused in higher frequencies (e. g. , the N1) and lower frequencies (e. g. , the P3b).  Previously, we found that HSMM-MVPA with a 50 ms bump accurately recovered the temporal location of 3 Hz signals (Anderson et al. , 2016), which is important given that the P3b reﬂects power in the delta and theta bands (Demiralp, Ademoglu, Comerchero, & Polich, 2001).  Second, bumps occur serially and do not overlap.  Third, ﬂat durations are modeled as a gamma distribution with a ﬁxed shape parameter 2 and a scale parameter estimated to ﬁt the data.  See Anderson et al.  (2016) for a detailed discussion of these assumptions, and demonstrations of the robustness of the method against violations of each.  In our previous studies, we used HSMM-MVPA to place n bumps between stimulus onset and response commission (Anderson et al. , 2016.  Zhang et al. , in press).  Fitting an n-bump HSMM requires estimating n + 1 stage distributions to describe the n + 1 periods of time collectively demarked by stimulus onset, the n bumps, and the response.  Most trials in the current tasks do not end with responses.  As such, we ﬁt n-bump HSMMs to the EEG from the ﬁrst full second of every trial in all tasks. 3 This requires estimating n stage distributions to describe the duration of the ﬂat preceding the ﬁrst bump, and the durations of the ﬂats separating the subsequent bumps.  Since the speciﬁc interval of time used in the HSMM-MVPA analysis did not end with a response and has no special signiﬁcance, we did not estimate a ﬂat duration from the last bump to the end of the interval.  Estimating an n-bump HSMM also requires estimating the topographical distributions of the n multidimensional bumps.  These are intended to capture signals, present in the 10 PCA dimensions, during the 50 ms windows where bumps are centered.  A bump is deﬁned as a 2-dimensional matrix of values Bij where j indexes the 5 samples that make up the 50 ms bump and i indexes the 10 PCA dimensions.  The bump values are calculated as Bij = Pj*Mi where Pj are the 5 sample weights (i. e. , 0. 309, 0. 809, 1. 000, 0. 809, and 0. 309) that describe the shape of a half-sine and Mi are the 10 PCA magnitudes for bump i.  The values of Pj are ﬁxed based on the half-sine shape, and the values of Mi are estimated for each bump.  To summarize, ﬁnding n bumps requires estimating n scale parameters for the gamma distributions that characterize the durations of the ﬂats that precede each bump, and 10 x n magnitudes Mi to capture the observed PCA scores during the 50 ms windows that each bumpThe likelihood of a set of ﬂat durations (t1, t2, .  .  . tn) during a trial.  The ﬁrst inner product in the equation describes the likelihoods of the ﬂat durations based on the gamma distributions they are drawn from.  HSMM-MVPA estimates the scale parameter (bk) for each gamma distribution.  The second inner product in the equation describes the likelihoods of the scores along each of the 10 PCA dimensions.  These are derived from the sum of the squared deviations between the observed PCA scores and the model scores, which are zero during the ﬂats and non-zero during the bumps (Anderson et al. , 2016).  The probability of the data in a trial is the sum of the probabilities of all possible placements of bumps within the trial, each calculated as above.  The HSMM-MVPA estimates parameters (tn stage durations and Mn bump topographies) that maximize the likelihood of the data over all trials of the experiment.  The HSMM uses an iterative expectation maximization algorithm (Dempster, Laird, & Rubin, 1977). 
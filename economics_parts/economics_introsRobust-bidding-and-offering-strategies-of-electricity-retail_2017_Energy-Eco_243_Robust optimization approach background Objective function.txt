 1.  Introduction In order to supply end-user customers and determine optimum selling price for expected proﬁt maximization, uncertainty modeling of market price and demand should be done by retailer (Growe-Kuska et al. , 2003).  The retailer can determine the selling price based on ﬁxed price, time-of-use price or real-time price.  Finally, the retailer should prepare the curves for day-ahead market to purchase (sell) power from (to) the power market.  It should be noted that retailer can use the power market, bilateral contracts, self-dispatchable distributed generation units (DGs) and renewable energy sources (PV systems & wind turbines) to supply demand of customers.  But, sometimes it is possible that demand of customers is low.  Therefore, surplus energy from renewable energy sources and DG units can be sold to power market by retailer.  Therefore, in addition to determining the optimal bidding curves, optimal offering curves of retailer are obtained based on proposed robust optimization approach in the proposed paper.  1. 1.  Literature review.  The researches about determination of retail price by retailer are generally classiﬁed into three time periods containing long-term, midterm and short-term planning.  The review of related researches is categorized based on objective function, type of selling price determination, solution methodology and uncertainty modeling.  In long-term planning, Ref.  (Nojavan et al.  (2017d) minimizes total cost without pricing, uncertainty modeling, demand response program (DRP) and smart grid technology and maximization of expected proﬁt considering uncertainty modeling using scenario-based stochastic model is provided in Ref.  Ahmadi et al.  (2013) without pricing.  It should be mentioned that used ROA in Khojasteh and Jadid (2015) and Nojavan and Aalami (2015) is related to mid-term planning of retailer in which only the bidding curve has been obtained without pricing while the proposed ROA is used in this paper in short-term planning of retailer to obtain the bidding and offering curves for the power market under ﬁxed pricing (FP), time-of-use pricing (TOU) and realtime pricing (RTP).  Furthermore, short-term planning of retailer is reviewed in Hatami et al.  (2009), Nojavan et al.  (2015b), 2017c, Charwand et al.  (2015), Mahmoudi-Kohan et al.  (2010a), Hajati et al.  (2011), and Fleten and Pettersen (2005).  These researches are organized similar to mid-term planning.  The objective functions of short-term planning are profit maximization (Hatami et al. , 2009.  Nojavan et al. , 2015b, 2017c.  Mahmoudi-Kohan et al. , 2010a.  Hajati et al. , 2011.  Fleten and Pettersen, 2005) or costminimization (Charwand et al. , 2015.  Mahmoudi-Kohan et al. , 2010a.  Nojavan et al. , 2017c).  Unlike mid-term planning, realtime pricing (Hajati et al. , 2011.  Nojavan et al. , 2017c) as well as fixed pricing (Hatami et al. , 2009.  Mahmoudi-Kohan et al. , 2010a.  Fleten and Pettersen, 2005) and time-of-use pricing (Nojavan et al. , 2015b) are used as different types of selling price in short-term planning.  Also, Stackelberg game (Nojavan et al. , 2017c), genetic algorithm (Charwand et al. , 2015) or GAMS (Hatami et al. , 2009.  Nojavan et al. , 2015b.  Mahmoudi-Kohan et al. , 2010a.  Hajati et al. , 2011.  Fleten and Pettersen, 2005) are used to solve the problem.  Furthermore, in Nojavan et al.  (2015b), Charwand et al.  (2015), and Hajati et al.  (2011) the uncertainty modeling is not considered.  Also, scenario based method and IGDT are used as uncertainty modeling approaches in Hatami et al.  (2009), Fleten and Pettersen (2005), Nojavan et al.  (2017c) and Mahmoudi-Kohan et al.  (2010a), respectively.  1. 2.  Aims, scope, procedure and contributions.  In this paper, the electricity market price uncertainty implies that the final profit of the retailer is unknown.  Therefore, input parameters uncertainty modeling is necessary.  Since forecasted price is “probably wrong”, we rely on the minimum and maximum limits of electricity market price versus the real estimation (Kettunen et al. , 2010).  Moreover, we incorporate these upper and lower bounds for the forecasted price with robust optimization approach (as explained in Ref.  Gabriel et al. , 2002) to create the bidding (offering) curves of retailer for optimal bidding (offering) to the day-ahead market.  The proﬁt of retailer can be modeled as a MIP problem considering the forecasted price.  If the upper and lower bounds for the forecasted price are considered instead of price forecast, the optimal bidding (offering) strategy can be reformulated as an robust mixed integer linear programming (RMIP) problem (Gabriel et al. , 2002).  Regarding the upper and lower bounds of price, the proposed approach conducts to robust decision within the deﬁned price limits.  This robustness decision is important and contributes to the price-taker retailer which optimal bidding and offering strategies are obtained based on the proposed robust optimization approach.  Also, robust scheduling of alternative energy sources containing pool market, bilateral contracts, DG units and energy storage system is obtained based on the proposed robust optimization approach.  Furthermore, scenario-based stochastic framework is used for uncertainty modeling of demand, wind speed, irradiation and temperature.  Based on the explanation above, the novelty and contributions of this research can be listed as follows.  1) Optimal bidding and offering curves of retailer are obtained based on the robust optimization approach.  2) Robust scheduling of alternative energy sources is evaluated based on the proposed approach.  The paper is organized as follows.  Optimal selling price determination for the retailer under uncertainties is modeled in Section 2.  Background of robust optimization approach is presented in Section 3.  The proposed robust models as well as the flowchart algorithm for obtaining the optimal bidding (offering) curves of retailer are provided in Section 4.  The results of three case studies have been presented and analyzed in Section 5.  Finally, the relevant conclusions are presented in Section 6.  Furthermore, short-term planning of retailer is reviewed in Hatami et al.  (2009), Nojavan et al.  (2015b), 2017c, Charwand et al.  (2015), Mahmoudi-Kohan et al.  (2010a), Hajati et al.  (2011), and Fleten and Pettersen (2005).  These researches are organized similar to mid-term planning.  The objective functions of short-term planning are proﬁt maximization (Hatami et al. , 2009.  Nojavan et al. , 2015b, 2017c.  Mahmoudi-Kohan et al. , 2010a.  Hajati et al. , 2011.  Fleten and Pettersen, 2005) or cost minimization (Charwand et al. , 2015.  Mahmoudi-Kohan et al. , 2010a.  Nojavan et al. , 2017c).  Unlike mid-term planning, realtime pricing (Hajati et al. , 2011.  Nojavan et al. , 2017c) as well as ﬁxed pricing (Hatami et al. , 2009.  Mahmoudi-Kohan et al. , 2010a.  Fleten and Pettersen, 2005) and time-of-use pricing (Nojavan et al. , 2015b) are used as different types of selling price in short-term planning.  Also, Stackelberg game (Nojavan et al. , 2017c), genetic algorithm (Charwand et al. , 2015) or GAMS (Hatami et al. , 2009.  Nojavan et al. , 2015b.  Mahmoudi-Kohan et al. , 2010a.  Hajati et al. , 2011.  Fleten and Pettersen, 2005) are used to solve the problem.  Furthermore, in Nojavan et al.  (2015b), Charwand et al.  (2015), and Hajati et al.  (2011) the uncertainty modeling is not considered.  Also, scenario based method and IGDT are used as uncertainty modeling approaches in Hatami et al.  (2009), Fleten and Pettersen (2005), Nojavan et al.  (2017c) and Mahmoudi-Kohan et al.  (2010a), respectively.  1. 2.  Aims, scope, procedure and contributions.  In this paper, the electricity market price uncertainty implies that the ﬁnal proﬁt of the retailer is unknown.  Therefore, input parameters uncertainty modeling is necessary.  Since forecasted price is “probably wrong”, we rely on the minimum and maximum limits of electricity market price versus the real estimation (Kettunen et al. , 2010).  Moreover, we incorporate these upper and lower bounds for the forecasted price with robust optimization approach (as explained in Ref.  1. 3.  Structure of the paper.  The paper is organized as follows.  Optimal selling price determination for the retailer under uncertainties is modeled in Section 2.  Background of robust optimization approach is presented in Section 3.  The proposed robust models as well as the ﬂowchart algorithm for obtaining the optimal bidding (offering) curves of retailer are provided in Section 4.  The results of three case studies have been presented and analyzed in Section 5.  Finally, the relevant conclusions are presented in Section 6.  <Middle> Problem formulation.  The objective function is to maximize the expected profit of the retailer (revenue minus cost) in day-ahead market.  The revenue is obtained from selling energy to the end users.  Also, the total procurement cost of retailer includes the purchased costs of energy from pool market, bilateral contracts and dispatchable distributed generation units (DGs).  The energy procurement cost due to bilateral contracts is expressed by Eq.  (1).  The allowable limits of procured power through bilateral contract and total energy procurement from bilateral contracts are expressed in Eqs.  (2) and (3), respectively (Nojavan et al. , 2017b).  A piecewise linear operation cost modeling of DG units is expressed in Eq.  (5) according to Conejo et al.  (2005).  The technical constraints are presented in Eqs.  (6)–(13).  The purchased energy from DGs is limited by Eqs.  (6) and (7).  Also, the ramp up/down rate limits are expressed in constraints (Eqs.  (8) and (9)), respectively.  Finally, Eqs.  (10) and (11) describe theminimumup/down time constraints.  Also, the auxiliary variables Upi, j and Dni, j are defined in Eqs.  (12) and (13) for linear modeling of minimum up/down time of DGs (Aalami and Nojavan,The available power ofwind turbine and PV systemcan be calculated using Eqs.  (14) and (15) according to Conejo et al.  (2005), respectively.  Also, it should be noted that the Weibull distribution curve is used to generate scenarios for wind speed and normal distribution curve is used to generate scenarios for radiation and temperature uncertainty modeling in stochastic model.  The technical constraints of ESS are presented in Eqs.  (16)–(21) (Shahidehpour et al. , 2002).  The initial condition of ESS is expressed in Eq.  (16).  Eqs.  (17)–(18) consider the power limits of charging and discharging modes.  The lower and upper limits of stored energy in ESS are expressed in Eq.  (19).  Eq.  (20) shows the binary mode of charge and discharge which cannot occur simultaneously.  The energy dynamic model of ESS is shown in Eq.  (21).  Versus the determination of selling price by retailer (SP(l, t)), customers are ﬂexible.  Also, the retailer sets a quantity from customers demand based on price-demand curve of customers offered to the retailer to procure their demand (D(l,t,s)) according to Fig.  1.  This ﬁgure shows the price-demand curve of customers for 1 h.  According to Fig.  1, high selling price makes many customers not purchase from this retailer which leads to reduction of supplied demand by retailer.  Also, low selling price leads to increase of supplied demand by retailer since many customers purchase their demands from the retailer.  Therefore, retailer should determine the optimal selling price to maximize his expected proﬁt.  Supplied demand by the retailer is computed by equations shown below.  Through Eqs.  (22)–(25), it is clear that the demand of each customer supplied by the retailer in every period is a function of selling price.  The revenue obtained fromcustomer l in time period t by selling energy to the end-user customers can be computed as follows.  Finally, the profit objective function of the retailer can be expressed as this.  The proposed objective function (28) should be maximized subject to constraints (1)–(27).  In order to obtain the optimal bidding and offering curves of retailer in the smart grid environment, the uncertainty modeling of market price, demand, wind speed, temperature and irradiation are necessary.  It should be noted the scenario-based stochastic framework is used to model uncertainty of demand, wind speed, temperature and irradiation while robust optimization approach is proposed to model uncertainty of market price.  Also, it should be noted that real electricitymarket price is considered in the proposed objective function which is modeled using robust optimization approach.  In the proposed model, the selling price is generally modeled for time periods.  Therefore, according to constraint (29), this selling price is the same RTP that should be determined by the retailer.  Also, the constraint (29) should be replaced with constraint (30) in fixed price determination by the retailer.  According to constraint (30), the selling price is determined fixed based on decision maker of retailer for all-time periods.  Furthermore, the constraint (29) should be replaced with constraint (31) in determination of time-of-use pricing by decisionmaker of retailer.  The constraint (31) emphasizes that the selling price is determined for low, medium and peak periods by the retailer.  It should be noted that the pool market prices λt are uncertain parameters in the above problem.  In this paper, the pool market prices uncertainty is modeled using ROA.  2. 1.  Scenario-based stochastic framework In order to model the uncertainty of demand, temperature, irradiation and wind speed, the forecast error distribution curves are divided into five intervals with the width of one standard deviation (Mahmoudi-Kohan et al. , 2010b).  In uncertainty modeling, the used values for parameters in deterministic solution are considered as mean values.  The standard deviation for uncertain parameters is considered to be 10%.  Fig.  2 shows a sample discrete form of the predication error probability distribution function.  It is essential that for every available scenario two values be computed (Bertsimas and Sim, 2003).  1.  By integrating the area below the probability distribution curve in every period, we can acquire each scenario’s probability.  2.  The realized prediction error in each relevant scenario is considered to be the average amount of period.  For four uncertainty parameters in this paper, five scenarios are independently generated based on their probability distribution function.  Therefore, total number of scenarios will be 54 = 625.  The proposed model is complex and therefore in order to decrease the computing time, the number of scenarios is reduced to five based on scenario reduction technique by Kantorovich distance approach (Carrion et al. , 2009).  3.  Robust optimization approach background Objective function (28) subject to constraints (1)–(27) and (29)-(31) is modeled based on MIP programming.  Therefore, the proposed model can be formulated in the following standardMIP form. 